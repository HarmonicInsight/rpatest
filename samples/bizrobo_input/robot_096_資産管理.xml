<?xml version="1.0" encoding="UTF-8"?>
<BizRoboRobot name="資産管理_096" version="10.7">
    <Settings>
        <DesktopAutomation enabled="true"/>
        <Timeout value="61"/>
    </Settings>
    <Variables>
        <Variable name="url" type="String" default="C:\Data\資産管理_096.xlsx"/>
        <Variable name="filePath" type="String" default="C:\Data\資産管理_096.xlsx"/>
        <Variable name="outputPath" type="String" default="C:\Data\資産管理_096.xlsx"/>
        <Variable name="dataTable" type="DataTable" default=""/>
        <Variable name="rowCount" type="Integer" default="0"/>
        <Variable name="isSuccess" type="Boolean" default="false"/>
        <Variable name="errorMsg" type="String" default="C:\Data\資産管理_096.xlsx"/>
    </Variables>
    <Actions>
        <TryCatch>
        <ForEach collection="dataTable" itemVariable="row">
            <If condition="row != null">
                <ExcelReadRange sheet="Sheet1" range="A1:Z100"/>
                <Delay duration="3887"/>
                <ExtractData/>
                <SendMail to="admin@example.com" subject="処理結果通知"/>
                <Navigate url="https://erp.example.com"/>
                <SendMail to="admin@example.com" subject="処理結果通知"/>
                <OpenBrowser url="https://example.com" browserType="Chrome"/>
                <Click selector="#submit"/>
                <Log message="処理完了" level="Info"/>
                <WaitElement selector="#loading" timeout="13"/>
                <Navigate url="https://erp.example.com"/>
                <OpenBrowser url="https://example.com" browserType="Chrome"/>
                <TypeInto selector="#input_8" text="${variable}"/>
                <Assign variable="result" value="processed"/>
                <Switch/>
                <ExcelReadRange sheet="Sheet1" range="A1:Z100"/>
                <Delay duration="2244"/>
                <TryCatch/>
                <Assign variable="result" value="processed"/>
                <ExtractData/>
                <CopyFile source="C:\temp\in.txt" destination="C:\temp\out.txt"/>
                <Log message="処理完了" level="Info"/>
                <CopyFile source="C:\temp\in.txt" destination="C:\temp\out.txt"/>
                <Click selector="#next"/>
                <TypeInto selector="#input_2" text="${variable}"/>
                <WaitElement selector="#loading" timeout="25"/>
                <TryCatch/>
                <ExcelOpen filePath="C:\Data\output.xlsx"/>
                <ExcelOpen filePath="C:\Data\data.xlsx"/>
                <Switch/>
            </If>
        </ForEach>
        </TryCatch>
    </Actions>
    <SubRobots>
        <SubRobot ref="共通_ログイン処理"/>

    </SubRobots>
</BizRoboRobot>