<?xml version="1.0" encoding="UTF-8"?>
<BizRoboRobot name="レポート生成_077" version="10.7">
    <Settings>
        <DesktopAutomation enabled="false"/>
        <Timeout value="118"/>
    </Settings>
    <Variables>
        <Variable name="inputPath" type="String" default="C:\Data\レポート生成_077.xlsx"/>
        <Variable name="outputPath" type="String" default="C:\Data\レポート生成_077.xlsx"/>
        <Variable name="dataTable" type="DataTable" default=""/>
        <Variable name="count" type="Integer" default="0"/>
        <Variable name="status" type="String" default="C:\Data\レポート生成_077.xlsx"/>
    </Variables>
    <Actions>
        <TryCatch>
        <ForEach collection="dataTable" itemVariable="row">
            <If condition="row != null">
                <Log message="処理完了" level="Info"/>
                <Assign variable="result" value="processed"/>
                <ExcelReadRange sheet="Sheet1" range="A1:Z100"/>
                <ExcelWriteRange sheet="結果" range="A1"/>
                <SendMail to="admin@example.com" subject="処理結果通知"/>
                <ExcelReadRange sheet="Sheet1" range="A1:Z100"/>
                <ExcelWriteRange sheet="結果" range="A1"/>
                <SendMail to="admin@example.com" subject="処理結果通知"/>
                <Switch/>
                <Assign variable="result" value="processed"/>
                <Switch/>
                <ExcelOpen filePath="C:\Data\output.xlsx"/>
                <Log message="処理完了" level="Info"/>
                <ExcelOpen filePath="C:\Data\input.xlsx"/>
            </If>
        </ForEach>
        </TryCatch>
    </Actions>
    <SubRobots>
        <SubRobot ref="共通_ログイン処理"/>
        <SubRobot ref="共通_メール送信"/>
    </SubRobots>
</BizRoboRobot>